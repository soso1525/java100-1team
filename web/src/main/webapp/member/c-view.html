<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>회원관리</title>
<link rel="shortcut icon" href="images/favicon/favicon.ico">
<link rel="apple-touch-icon" sizes="144x144" type="image/x-icon" href="../images/favicon/apple-touch-icon.png">
<link rel="stylesheet" type="text/css" href="../css/plugin.css">
<link rel="stylesheet" type="text/css" href="../css/style.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:400,300,500,600,700">
</head>
<body>
	<div class="container">
		<h1 style="margin-top: 30px; margin-bottom: 30px">기업회원 상세 정보</h1>

		<form id="form" method='post' enctype="multipart/form-data">
			
			<div class="form-row">
				<div class="col-md-6 mb-3">
					<label for="cname">Name</label> <input type="text"
						class="form-control" id="cName" name="cName">
				</div>
			</div>
			<div class="col-md-6 mb-3">
				<input type="hidden" class="form-control" id="cno" name="cno">
			</div>

			<div class="form-row">
				<div class="col-md-6 mb-3">
					<label for="ckind">kind</label> <input type="text"
						class="form-control" id="cKind" name="cKind">
				</div>
			</div>

			<div class="form-row">
				<div class="col-md-6 mb-3">
					<label for="cType">Phone</label> <input type="text"
						class="form-control" id="cType" name="cType">
				</div>
			</div>

			<div class="form-row">
				<div class="col-md-6 mb-3">
					<label for="businessNo">businessNo</label> <input type="text"
						class="form-control" id="businessNo" name="businessNo">
				</div>
			</div>

			<div class="form-row">
				<div class="col-md-6 mb-3">
					<label for="logo">logo</label> <input type="file"
						class="form-control" id="logo" name="file">
				</div>
			</div>
			<div class='col-sm-10'>
				<button id="updateBtn" type="button"
					class='btn btn-primary btn-sm my-new'>변경</button>
			</div>
		</form>
	</div>

	<script src='../node_modules/jquery/dist/jquery.min.js'></script>
	<script src='../node_modules/popper.js/dist/umd/popper.min.js'></script>
	<script src='../node_modules/bootstrap/dist/js/bootstrap.min.js'></script>
	<script type="text/javascript" src="../js/context.js"></script>
	<script type="text/javascript">
	var updateBtn = $('#updateBtn');
	var index = location.href.indexOf('?');
	if (index != -1) { 
	    var qs = location.href.substr(index + 1);
	    var arr = qs.split('=');
	    $(() => {
	        $.ajax(host + '/json/company/' + arr[1], {
	            dataType: 'json',
	            success: (result) => {
	            	$('#cno').val(result.cmember.cno);
	            	$('#cName').val(result.cmember.cName);
	            	$('#cKind').val(result.cmember.cKind);
	            	$('#cType').val(result.cmember.cType);
	            	$('#businessNo').val(result.cmember.businessNo);
	            },
	            error: () => {
	                window.alert('서버 실행 오류!');
	            }
	        });
	    });
	}
	updateBtn.click(() => {
		var formData = new FormData($('#form')[0]);
	    $.ajax(host + '/json/company/update', {
	        data: formData,
	        dataType: 'json',
	        method: 'POST',
	        processData : false,
	        contentType : false,
	        success: (result) => {
	            location.href = "list.html";
	        },
	        error: () => {
	            window.alert('서버 실행 오류!');
	        }
		});
	});
	</script>
</body>
</html>