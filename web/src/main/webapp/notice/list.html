<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>기업목록</title>
	<link rel='stylesheet' href='../../css/common.css'>
    
    <!-- All CSS Plugins -->
    <link rel="stylesheet" type="text/css" href="../css/plugin.css">
    
    <!-- Main CSS Stylesheet -->
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    
    <!-- Google Web Fonts  -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:400,300,500,600,700">
</head>
<body>
<header></header>
	<section id="services" class="services-section section-space-padding">
        <div class="container">
            <div class="col-sm-12 search">
	            <div class="col-sm-12">
	            	<div class="col-sm-3">
	            		<strong>What</strong>
	            	</div>
	            	<div class="col-sm-3">
	            		<strong>Occupation</strong>
	            	</div>
	            	<div class="col-sm-3">
	            		<strong>Where</strong>
	            	</div>
	            </div>
	            
	            <div class="col-sm-12">
					<form>
						<div class="col-sm-3">
							<input name="words" id="words" class="form-control form-control-sm mr-sm-2"
								type="search" placeholder="Keyword" aria-label="Search"> 
						</div>
						<div class="col-sm-3">
							<select id="cKind" name="cKind" class="form-control form-control-sm mr-sm-2">
								<option>전체</option>
								<option>건설</option>
								<option>경영/사무</option>
								<option>교육</option>
								<option>디자인</option>
								<option>미디어</option>
								<option>서비스</option>
								<option>생산/제조</option>
								<option>IT/인터넷</option>
								<option>영업/고객상담</option>
								<option>유통/무역</option>
								<option>의료</option>
								<option>전문직</option>
								<option>특수계층/공공</option>
							</select> 
						</div>
						<div class="col-sm-3">
							<select id="address" name="address" class="form-control form-control-sm mr-sm-2">
								<option>전체</option>
								<option>강남구</option>
								<option>강동구</option>
								<option>강북구</option>
								<option>강서구</option>
								<option>관악구</option>
								<option>광진구</option>
								<option>구로구</option>
								<option>금천구</option>
								<option>노원구</option>
								<option>도봉구</option>
								<option>동대문구</option>
								<option>동작구</option>
								<option>마포구</option>
								<option>서대문구</option>
								<option>서초구</option>
								<option>성동구</option>
								<option>성북구</option>
								<option>송파구</option>
								<option>양천구</option>
								<option>영등포구</option>
							</select>
						</div>
						<div class="col-sm-2" style="width:8%;">
							<label class="switch">
							  <input id="nType" type="checkbox">
							  <span class="slider round"></span>
							</label>
							<strong class="my-check">신입</strong><strong class="my-check" style="display:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;경력</strong>
						</div>
						<div class="col-sm-2">
							<button style="margin-left: 10px" class="button search button-style button-style-dark button-style-color-2" type="button" id="searchBtn">Catch</button>
						</div>
					</form>
				</div>
			</div>
			<div class= "notice-list">
				<ul id="list">
				</ul>
			</div>
			
			<button type="button" class='btn btn-primary btn-sm' id="btn-add"
				onclick="location.href='form.html'">추가</button>
			<nav aria-label="Page navigation">
			  <ul class="pagination justify-content-center">
			    <li class="page-item">
			        <a id="prevBtn" class="page-link" tabindex="-1">이전</a></li>
			        
			    <li class="page-item">
			        <a id="currBtn" class="page-link" href="#">1</a></li>
			    
			    <li class="page-item ">
			        <a id="nextBtn" class="page-link" tabindex="0">다음</a></li>
			  </ul>
			</nav>
		</div>
	</section>
	
<script id="notice" type="text/x-handlebars-template">
{{#each list}}
<li>
	<div class="notice-head">
		<img class="notice-img-top" src='../../download/{{companyMember.logo}}' alt="Card image cap">
	</div>
	<div class="notice-body">
  		<p class="notice-title">{{companyMember.cName}}</p><br>
  		<p class="notice-text">{{duty}}</p><br>
		<div class="notice-footer">
			<p class="notice-text">{{d-day}}</p><br>
		</div>
	</div>
</li>
{{/each}}
</script>


<script src='../node_modules/handlebars/dist/handlebars.min.js'></script>
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script type="text/javascript" src="../js/plugin.js"></script>
<script type="text/javascript" src="../js/scripts.js"></script>
</body>
<script type="text/javascript">
$('header').load("../header.html");

var check = $("input[type='checkbox']");
check.click(function(){
  $(".my-check").toggle();
});

var prevBtn = $('#prevBtn'),
  	currBtn = $('#currBtn'),
  	nextBtn = $('#nextBtn'),
  	words = $('#words'),
	searchBtn = $('#searchBtn'),
	listItem = $('#list'),
   	currPageNo = 1,
 	noticeSrc = $('#notice').html(),
 	nTypeItem = $('#nType'),
 	noticeEngine = Handlebars.compile(noticeSrc);

function parse(str) {
	var date = str.split('-');
	console.log(date);
	return date;
}




load(1);


searchBtn.click(() => {
	var nType = 0;
	if (nTypeItem.prop("checked")) {
		nType = 1;
	}
    load(1, {
        "words": words.val(),
        "cKind": $('#cKind option:selected').text(),
        "address": $('#address option:selected').text(),
        "nType": nType
    })
});
 
prevBtn.click(() => {
    load(currPageNo - 1)
});

nextBtn.click(() => {
    load(currPageNo + 1)
    console.log(currPageNo + 1);
});


function load(pageNo, options) {
    
     if (options == undefined) options = {};
     options.pn = pageNo;
    
    $.ajax('../json/notice/list', {
    	data: options,
        dataType: 'json',
        success: (result) => {
        	Handlebars.registerHelper('d-day', function(endDate){
        		
        		var g = parse(endDate);
        		console.log(g);
                return g;
            });
            listItem.html(noticeEngine(result));
            currPageNo = result.pageNo;
            currBtn.html(currPageNo);
            if (result.pageNo == 1) {
                $(prevBtn.parent()).addClass("disabled");
            } else {
                $(prevBtn.parent()).removeClass("disabled");
            }
            
            if (result.lastPageNo == result.pageNo) {
                $(nextBtn.parent()).addClass("disabled");
            } else {
                $(nextBtn.parent()).removeClass("disabled");
            }
       },
       error: () => {
            window.alert('서버 실행 오류!');
       } 
    }); 
     
} 

</script>
</html>
