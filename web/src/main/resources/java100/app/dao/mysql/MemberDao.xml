<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="java100.app.dao.MemberDao">
	<resultMap type="member" id="memberMap">
		<id column="pno" property="no" />
		<result column="pmail" property="email" />
		<result column="pid" property="id" />
		<result column="ptype" property="type" />
		<result column="ppwd" property="password" />
		<result column="pregdt" property="createdDate" />
		<result column="ptel" property="tel" />
		<result column="pdaddr" property="address" />
	</resultMap>

	<sql id="select1">
		select
		pno,
		pid,
		pmail,
		pregdt
	</sql>

	<select id="findAll" resultMap="memberMap" parameterType="map">
		<include refid="select1" />
		from g_per
		limit #{startIndex}, #{size} -->
	</select>

	<select id="findByNo" resultMap="memberMap" parameterType="int">
		<include refid="select1" />
		from g_per

		where no=#{value}
	</select>

	<select id="findByIdAndPassword" resultMap="memberMap"
		parameterType="map">
		<include refid="select1" />
		from g_per
		where pid=#{id} and ppwd=password(#{password})
	</select>

	<select id="findById" resultMap="memberMap" parameterType="map">
		<include refid="select1" />
		from g_per
		where pid=#{id}
	</select>

	<select id="findByEmail" resultMap="memberMap" parameterType="map">
		<include refid="select1" />
		from g_per
		where pmail=#{email}
	</select>

	<select id="countAll" resultType="int">
		select count(*) from g_per
	</select>

	<insert id="insert" parameterType="member">
		insert into
		g_per(pmail,pid,ppwd,pregdt,ptel,pdaddr,ptype)
		values(#{email},#{id},password(#{password}),now(),#{tel},#{address},#{type})
	</insert>

</mapper>  









